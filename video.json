{
  "name": "Gemini Veo Multi-Output Logic",
  "nodes": [
    {
      "parameters": {
        "jsCode": "// 이전 노드에서 Gemini가 생성한 텍스트와 이미지 URL을 가져옵니다.\n// 실제 사용 시 $json[\"text\"] 등으로 경로를 맞춰주세요.\nconst generatedText = `\nVideo Prompt 1: A cinematic shot of a model walking down a runway wearing a futuristic silver dress.\nVideo Prompt 2: A close-up detail shot of the fabric texture shimmering under neon lights.\n`;\nconst imageUrl = $(\"HTTP Request (이미지 생성)\").first().json.url || \"https://example.com/image.jpg\";\n\n// 텍스트를 줄바꿈으로 나누어 프롬프트 2개를 찾습니다.\nconst lines = generatedText.split('\\n');\nconst prompt1 = lines.find(l => l.includes(\"Prompt 1\")) || \"Default Prompt 1\";\nconst prompt2 = lines.find(l => l.includes(\"Prompt 2\")) || \"Default Prompt 2\";\n\n// [핵심] 여기서 배열([]) 안에 2개의 객체({})를 넣어 반환하면,\n// n8n은 자동으로 이후 노드들을 2번(각 아이템마다) 실행합니다.\nreturn [\n  {\n    json: {\n      video_prompt: prompt1.replace(\"Video Prompt 1:\", \"\").trim(),\n      base_image: imageUrl,\n      id: \"video_01\"\n    }\n  },\n  {\n    json: {\n      video_prompt: prompt2.replace(\"Video Prompt 2:\", \"\").trim(),\n      base_image: imageUrl,\n      id: \"video_02\"\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        0
      ],
      "id": "e98e2912-3b10-4123-952b-8a7c12345678",
      "name": "Code (2개의 아이템 생성)"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.example.com/generate-video",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "prompt",
              "value": "={{ $json.video_prompt }}"
            },
            {
              "name": "image_url",
              "value": "={{ $json.base_image }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        220,
        0
      ],
      "id": "a23b4932-5d30-5345-074d-0c9e34567890",
      "name": "HTTP Request (비디오 생성 요청)"
    },
    {
      "parameters": {
        "amount": 10,
        "unit": "seconds"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [
        440,
        0
      ],
      "id": "b34c5043-6e40-6456-185e-1d0f45678901",
      "name": "Wait (10초 대기)"
    },
    {
      "parameters": {
        "url": "={{ $json.status_url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        660,
        0
      ],
      "id": "c45d6154-7f50-7567-296f-2e1a56789012",
      "name": "Check Status (상태 확인)"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.status }}",
              "value2": "completed"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        880,
        0
      ],
      "id": "d56e7265-8a60-8678-307g-3f2b67890123",
      "name": "Is Done? (완료 확인)"
    },
    {
      "parameters": {
        "url": "={{ $json.video_result_url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1100,
        -100
      ],
      "id": "e67f8376-9b70-9789-418h-4g3c78901234",
      "name": "Download Video (다운로드)"
    }
  ],
  "connections": {
    "Code (2개의 아이템 생성)": {
      "main": [
        [
          {
            "node": "HTTP Request (비디오 생성 요청)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (비디오 생성 요청)": {
      "main": [
        [
          {
            "node": "Wait (10초 대기)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait (10초 대기)": {
      "main": [
        [
          {
            "node": "Check Status (상태 확인)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Status (상태 확인)": {
      "main": [
        [
          {
            "node": "Is Done? (완료 확인)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Done? (완료 확인)": {
      "main": [
        [
          {
            "node": "Download Video (다운로드)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait (10초 대기)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}